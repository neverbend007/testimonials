<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testimonials - AI/Automation Agency</title>
    <meta name="description" content="Share your experience with our AI and automation services. Read testimonials from satisfied clients and community members.">
    <link rel="stylesheet" href="/styles.css">
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Testimonials - AI/Automation Agency">
    <meta property="og:description" content="Share your experience with our AI and automation services.">
    <meta property="og:type" content="website">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "AI/Automation Agency",
        "description": "Leading provider of AI and automation solutions",
        "url": "https://testimonials.example.com"
    }
    </script>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="container nav-container">
            <a href="/" class="nav-brand">
                <svg class="nav-brand-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                Testimonials
            </a>
            
            <ul class="nav-links">
                <li><a href="/" class="nav-link active">Home</a></li>
                <li><a href="/submit" class="nav-link">Share Experience</a></li>
                <li><a href="/testimonials" class="nav-link">View Testimonials</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1 class="text-balance">Share Your AI & Automation Success Story</h1>
                <p class="text-lead text-balance">
                    Help others discover the transformative power of AI and automation by sharing your experience with our services and community.
                </p>
                <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                    <a href="/submit" class="btn btn-primary btn-lg">
                        <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                        </svg>
                        Submit Your Story
                    </a>
                    <a href="/testimonials" class="btn btn-secondary btn-lg">
                        <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                        </svg>
                        Read Stories
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Statistics Section -->
    <section style="padding: 4rem 0; background: white;">
        <div class="container">
            <div class="text-center mb-8">
                <h2>Trusted by Industry Leaders</h2>
                <p class="text-lead">Join hundreds of satisfied clients and community members who have transformed their businesses with AI and automation.</p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalTestimonials">0</div>
                    <div class="stat-label">Success Stories</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="avgRating">0.0</div>
                    <div class="stat-label">Average Rating</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="agencyClients">0</div>
                    <div class="stat-label">Agency Clients</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="communityMembers">0</div>
                    <div class="stat-label">Community Members</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section style="padding: 4rem 0;">
        <div class="container">
            <div class="text-center mb-8">
                <h2>Why Share Your Experience?</h2>
                <p class="text-lead">Your testimonial helps others make informed decisions while showcasing the real impact of AI and automation solutions.</p>
            </div>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <svg style="width: 1.5rem; height: 1.5rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                        </svg>
                    </div>
                    <h3>Help Others Succeed</h3>
                    <p>Your experience provides valuable insights that help other businesses and individuals make informed decisions about AI and automation solutions.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <svg style="width: 1.5rem; height: 1.5rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h3>Build Trust</h3>
                    <p>Authentic testimonials from real clients and community members build trust and credibility in our AI and automation services.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <svg style="width: 1.5rem; height: 1.5rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <h3>Showcase Results</h3>
                    <p>Highlight the real-world impact and transformative results achieved through our AI and automation solutions and community support.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Recent Testimonials Preview -->
    <section style="padding: 4rem 0; background: white;">
        <div class="container">
            <div class="text-center mb-8">
                <h2>Recent Success Stories</h2>
                <p class="text-lead">See what our clients and community members are saying about their AI and automation journey.</p>
            </div>
            
            <div id="recentTestimonials" class="testimonials-grid">
                <!-- Testimonials will be loaded here -->
            </div>
            
            <div class="text-center mt-8">
                <a href="/testimonials" class="btn btn-primary btn-lg">
                    View All Testimonials
                    <svg style="width: 1rem; height: 1rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                    </svg>
                </a>
            </div>
        </div>
    </section>

    <!-- Call to Action -->
    <section style="padding: 4rem 0; background: linear-gradient(135deg, var(--primary-50) 0%, var(--primary-100) 100%);">
        <div class="container">
            <div class="text-center">
                <h2>Ready to Share Your Story?</h2>
                <p class="text-lead mb-6">Join our community of satisfied clients and help others discover the power of AI and automation.</p>
                <a href="/submit" class="btn btn-primary btn-lg">
                    <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                    Submit Your Testimonial
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer style="padding: 2rem 0; background: var(--gray-900); color: var(--gray-300);">
        <div class="container">
            <div class="text-center">
                <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem; margin-bottom: 1rem;">
                    <svg style="width: 1.5rem; height: 1.5rem; color: var(--primary-400);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    <span style="font-weight: 600; color: white;">Testimonials Platform</span>
                </div>
                <p style="font-size: 0.875rem; margin-bottom: 1rem;">Empowering businesses through AI and automation solutions</p>
                <p style="font-size: 0.75rem; color: var(--gray-500);">
                    © 2024 AI/Automation Agency. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <!-- Loading overlay -->
    <div id="loadingOverlay" class="hidden" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255, 255, 255, 0.9); display: flex; align-items: center; justify-content: center; z-index: 1000;">
        <div class="loading">
            <div class="spinner"></div>
            Loading testimonials...
        </div>
    </div>

    <script>
        // API Configuration
        const API_BASE_URL = 'http://localhost:3001/api';

        // DOM Elements
        const totalTestimonialsEl = document.getElementById('totalTestimonials');
        const avgRatingEl = document.getElementById('avgRating');
        const agencyClientsEl = document.getElementById('agencyClients');
        const communityMembersEl = document.getElementById('communityMembers');
        const recentTestimonialsEl = document.getElementById('recentTestimonials');
        const loadingOverlay = document.getElementById('loadingOverlay');

        // Animation function for counting numbers
        function animateNumber(element, target, duration = 2000) {
            const start = 0;
            const increment = target / (duration / 16);
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    element.textContent = target.toFixed(target % 1 === 0 ? 0 : 1);
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(current).toString();
                }
            }, 16);
        }

        // Create star rating display
        function createStarRating(rating, maxRating = 5) {
            const container = document.createElement('div');
            container.className = 'star-display';
            
            for (let i = 1; i <= maxRating; i++) {
                const star = document.createElement('div');
                star.innerHTML = '★';
                star.className = `star ${i <= rating ? '' : 'empty'}`;
                container.appendChild(star);
            }
            
            return container;
        }

        // Format date for display
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        // Create testimonial card
        function createTestimonialCard(testimonial) {
            const card = document.createElement('div');
            card.className = `testimonial-card ${testimonial.is_featured ? 'featured' : ''}`;
            
            card.innerHTML = `
                <div class="testimonial-header">
                    <div class="testimonial-meta">
                        <div class="testimonial-author">${testimonial.full_name}</div>
                        ${createStarRating(testimonial.star_rating).outerHTML}
                    </div>
                </div>
                
                <div class="testimonial-text">${testimonial.testimonial_text}</div>
                
                <div class="testimonial-footer">
                    <span class="badge badge-secondary" style="margin-right: 0.5rem;">${testimonial.source_type}</span>${testimonial.is_featured ? '<span class="badge badge-featured">Featured</span>' : ''}
                </div>
            `;
            
            return card;
        }

        // Show error message
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'message error';
            errorDiv.innerHTML = `
                <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span>${message}</span>
            `;
            
            recentTestimonialsEl.innerHTML = '';
            recentTestimonialsEl.appendChild(errorDiv);
        }

        // Load statistics and recent testimonials
        async function loadData() {
            loadingOverlay.classList.remove('hidden');
            
            try {
                // Fetch testimonials
                const response = await fetch(`${API_BASE_URL}/testimonials?limit=50`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                const testimonials = data.testimonials || [];
                
                // Calculate statistics
                const totalCount = testimonials.length;
                const agencyClientCount = testimonials.filter(t => t.source_type === 'Agency Client').length;
                const communityMemberCount = testimonials.filter(t => t.source_type === 'Skool Community Member').length;
                const avgRating = totalCount > 0 
                    ? testimonials.reduce((sum, t) => sum + t.star_rating, 0) / totalCount 
                    : 0;
                
                // Animate statistics
                setTimeout(() => animateNumber(totalTestimonialsEl, totalCount), 200);
                setTimeout(() => animateNumber(avgRatingEl, avgRating), 400);
                setTimeout(() => animateNumber(agencyClientsEl, agencyClientCount), 600);
                setTimeout(() => animateNumber(communityMembersEl, communityMemberCount), 800);
                
                // Display recent testimonials (featured first, then by date)
                const sortedTestimonials = testimonials
                    .sort((a, b) => {
                        if (a.is_featured && !b.is_featured) return -1;
                        if (!a.is_featured && b.is_featured) return 1;
                        return new Date(b.approved_at || b.submitted_at) - new Date(a.approved_at || a.submitted_at);
                    })
                    .slice(0, 6); // Show only 6 testimonials on homepage
                
                recentTestimonialsEl.innerHTML = '';
                
                if (sortedTestimonials.length === 0) {
                    recentTestimonialsEl.innerHTML = `
                        <div class="text-center" style="grid-column: 1 / -1; padding: 3rem;">
                            <svg style="width: 3rem; height: 3rem; color: var(--gray-400); margin: 0 auto 1rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                            </svg>
                            <h3 style="color: var(--gray-600); margin-bottom: 0.5rem;">No testimonials yet</h3>
                            <p style="color: var(--gray-500); margin-bottom: 1.5rem;">Be the first to share your experience!</p>
                            <a href="/submit" class="btn btn-primary">Submit Your Testimonial</a>
                        </div>
                    `;
                } else {
                    sortedTestimonials.forEach(testimonial => {
                        recentTestimonialsEl.appendChild(createTestimonialCard(testimonial));
                    });
                }
                
            } catch (error) {
                console.error('Error loading data:', error);
                showError('Unable to load testimonials. Please try again later.');
                
                // Set default statistics on error
                totalTestimonialsEl.textContent = '0';
                avgRatingEl.textContent = '0.0';
                agencyClientsEl.textContent = '0';
                communityMembersEl.textContent = '0';
            } finally {
                loadingOverlay.classList.add('hidden');
            }
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
        });

        // Intersection Observer for fade-in animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        // Add fade-in animation to sections
        document.addEventListener('DOMContentLoaded', function() {
            const sections = document.querySelectorAll('section');
            sections.forEach(section => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(20px)';
                section.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(section);
            });
        });
    </script>
</body>
</html>